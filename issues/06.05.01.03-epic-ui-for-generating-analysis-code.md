---
title: "Epic: UI for Generating Analysis Code"
type: "Epic"
parent: "06.05.01-initiative-dataset-generation-ui.md"
state: "backlog"
labels:
  - "analysis-generation"
  - "ui"
assignees: []
---

### Description

Develop a user interface that allows users to generate analysis code in SAS or R for various outputs. This will provide a UI for the existing `generate-analysis` CLI command.

### Proposed Implementation

1.  **Refactor CLI:** Refactor the `generate_analysis` command in `src/cdisc_cli/main.py`. Extract the core logic into a reusable function in `src/cdisc_generators/analysis_generator.py`.
2.  **Add API Endpoint:** Create a new `POST /api/generate-analysis` endpoint in `src/ui/main.py`. It should accept parameters like `language`, `dataset`, `output_type`, and `treatment_var`.
3.  **Update Frontend Form:** Add a new form to `src/ui/templates/index.html` with fields for the analysis parameters.
4.  **Update Frontend Script:** Add JavaScript to `src/ui/static/js/main.js` to handle the new form submission, call the API, and display the path to the generated file.
5.  **Add Tests:** Add a new unit test to `tests/test_ui.py` for the new API endpoint, using mocking for the core logic.

### Acceptance Criteria

- A user can see a "Generate Analysis Code" section in the web UI.
- The form contains fields for Language (SAS, R), Source Dataset, Output Type, and Treatment Variable.
- The user can fill out the form and click a "Generate" button.
- After clicking "Generate", the UI shows a confirmation message with the path to the generated analysis file.
- The generated file is saved in the `output/ui_generated_data` directory.
- The existing `generate-analysis` CLI command continues to work as before the refactoring.
